{% extends 'base.html' %}{% block content %}<h2>Snake</h2><style>#game-container{position:relative;width:400px;height:400px;margin:0 auto}#game-board{border:3px solid #32c8e6}#overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(12,12,28,.8);color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-size:1.2em}</style><div id="game-container"><canvas id="game-board" width="400" height="400"></canvas><div id="overlay"><h3>Snake</h3><p>Benutze die Pfeiltasten.</p><button id="start-button">Spiel starten</button></div></div><h3 id="score-display" style="margin-top:20px">Score: 0</h3><script>const board=document.getElementById("game-board"),context=board.getContext("2d"),gridSize=20,tileSize=board.width/gridSize;let snake,food,score,direction,isGameOver,gameLoop,currentDifficulty;const scoreDisplay=document.getElementById("score-display"),overlay=document.getElementById("overlay"),startButton=document.getElementById("start-button");function startGame(e){currentDifficulty=e;const t={easy:150,medium:100,hard:60};snake=[{x:10,y:10}],direction="right",score=0,isGameOver=!1,scoreDisplay.textContent="Score: 0",placeFood(),overlay.style.display="none",clearInterval(gameLoop),gameLoop=setInterval(updateGame,t[e])}function placeFood(){food={x:Math.floor(Math.random()*gridSize),y:Math.floor(Math.random()*gridSize)};for(let e of snake)if(e.x===food.x&&e.y===food.y)return void placeFood()}function updateGame(){if(isGameOver)return;const e={x:snake[0].x,y:snake[0].y};"right"===direction?e.x++:"left"===direction?e.x--:"up"===direction?e.y--:"down"===direction&&e.y++,e.x<0||e.x>=gridSize||e.y<0||e.y>=gridSize||checkCollision(e)?gameOver():(snake.unshift(e),e.x===food.x&&e.y===food.y?(score++,scoreDisplay.textContent="Score: "+score,placeFood()):snake.pop(),draw())}function draw(){context.fillStyle="#1a1a2e",context.fillRect(0,0,board.width,board.height),context.fillStyle="#28a745";for(const e of snake)context.fillRect(e.x*tileSize,e.y*tileSize,tileSize-1,tileSize-1);context.fillStyle="#e94560",context.fillRect(food.x*tileSize,food.y*tileSize,tileSize,tileSize)}function checkCollision(e){for(let t=1;t<snake.length;t++)if(e.x===snake[t].x&&e.y===snake[t].y)return!0;return!1}function gameOver(){isGameOver=!0,clearInterval(gameLoop),overlay.style.display="flex",overlay.innerHTML=<h3>Game Over!</h3><p>Dein Score: \</p><form id="highscore-form"><input type="text" id="player-name" placeholder="Dein Name..." required><button type="submit">Highscore speichern</button></form><p>Neues Spiel:</p><div><button onclick="startGame('easy')">Leicht</button><button onclick="startGame('medium')">Mittel</button><button onclick="startGame('hard')">Schwer</button></div>,document.getElementById("highscore-form").addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("player-name").value;fetch("{% url 'games:save_score' %}",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":"{{ csrf_token }}"},body:JSON.stringify({player_name:t,score:score,game:"Snake",difficulty:currentDifficulty})}).then(()=>window.location.href="{% url 'games:highscores' %}")})}document.addEventListener("keydown",e=>{"ArrowUp"===e.key&&"down"!==direction?direction="up":"ArrowDown"===e.key&&"up"!==direction?direction="down":"ArrowLeft"===e.key&&"right"!==direction?direction="left":"ArrowRight"===e.key&&"left"!==direction&&(direction="right")}),startButton.addEventListener("click",()=>{startGame('medium')});</script>{% endblock %}
