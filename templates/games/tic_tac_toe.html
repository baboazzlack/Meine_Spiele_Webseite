{% extends 'base.html' %}
{% block title %}Tic-Tac-Toe{% endblock %}
{% block content %}
    <h2>Tic-Tac-Toe</h2>
    <style>
        .tic-tac-toe-board { margin: 20px auto; border-collapse: collapse; }
        .tic-tac-toe-board td { width: 100px; height: 100px; border: 3px solid #32c8e6; text-align: center; font-size: 3em; vertical-align: middle; }
        .tic-tac-toe-board button { width: 100%; height: 100%; font-family: 'Press Start 2P', cursive; background: none; border: none; color: #e0e0e0; font-size: 1em; cursor: pointer; }
        .tic-tac-toe-board button:hover { background-color: rgba(233, 69, 96, 0.2); }
        .difficulty-button { display: inline-block; text-decoration: none; padding: 15px 25px; margin: 10px; border-radius: 0; font-size: 1em; color: #FFFFFF; cursor: pointer; border: 2px solid; }
        .easy { background-color: #28a745; border-color: #28a745; }
        .medium { background-color: #ffc107; border-color: #ffc107; color: #1a1a2e;}
        .hard { background-color: #dc3545; border-color: #dc3545; }
    </style>

    {% if not board %}
        <h3>Wähle eine Schwierigkeitsstufe:</h3>
        <form method="post">
            {% csrf_token %}
            <button class="difficulty-button easy" type="submit" name="difficulty" value="easy">Leicht</button>
            <button class="difficulty-button medium" type="submit" name="difficulty" value="medium">Mittel</button>
            <button class="difficulty-button hard" type="submit" name="difficulty" value="hard">Schwer</button>
        </form>
    {% else %}
        <table class="tic-tac-toe-board">
            {% for row in board %}
                <tr>
                    {% for cell in row %}
                        <td>
                            {% if not cell and not winner %}
                                <form method="post" style="margin:0;">
                                    {% csrf_token %}
                                    <button type="submit" name="move" value="{{ forloop.parentloop.counter0 }},{{ forloop.counter0 }}">&nbsp;</button>
                                </form>
                            {% else %}
                                {{ cell }}
                            {% endif %}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
        <h3>{{ message }}</h3>
        
        {% if winner == 'X' %}
            <form method="post">
                {% csrf_token %}
                <input type="text" name="player_name" placeholder="Dein Name..." required>
                <button type="submit">Highscore speichern!</button>
            </form>
        {% elif winner %}
            <a href="{% url 'games:tic_tac_toe' %}?reset=true" class="play-button" style="display:inline-block; text-decoration:none; padding:10px 20px; border-radius:0;">Neues Spiel</a>
        {% endif %}
    {% endif %}

    <p style="margin-top: 30px;"><a href="{% url 'games:game_list' %}">Zurück zur Spiele-Übersicht</a></p>
{% endblock %}