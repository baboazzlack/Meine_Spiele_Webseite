{% extends 'base.html' %}{% block content %}<h2>Pong</h2><style>#game-container{position:relative;width:600px;height:400px;margin:0 auto;cursor:none}#game-board{border:3px solid #e0e0e0;background-color:#000}#overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.8);color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-size:1.2em}</style><div id="game-container"><canvas id="game-board" width="600" height="400"></canvas><div id="overlay"><h3>PONG</h3><p>Wähle eine Schwierigkeit:</p><div><button onclick="startGame('easy')">Leicht</button><button onclick="startGame('medium')">Mittel</button><button onclick="startGame('hard')">Schwer</button></div><p>Steuerung: Maus</p></div></div><script>const canvas=document.getElementById("game-board"),context=canvas.getContext("2d"),overlay=document.getElementById("overlay"),WINNING_SCORE=5,ball={x:300,y:200,radius:7,speed:5,dx:5,dy:5},player={x:10,y:160,width:10,height:80,score:0},computer={x:580,y:160,width:10,height:80,score:0};let gameLoopId,currentDifficulty;function startGame(e){currentDifficulty=e,player.score=0,computer.score=0,resetBall(),overlay.style.display="none",cancelAnimationFrame(gameLoopId),gameLoopId=requestAnimationFrame(update)}function resetBall(){ball.x=300,ball.y=200,ball.speed=5,ball.dx=.5<Math.random()?5:-5,ball.dy=.5<Math.random()?5:-5}function draw(){context.fillStyle="#000",context.fillRect(0,0,600,400),context.strokeStyle="#e0e0e0",context.lineWidth=4,context.beginPath(),context.setLineDash([10,10]),context.moveTo(300,0),context.lineTo(300,400),context.stroke(),context.setLineDash([]),context.fillStyle="#e0e0e0",context.font="40px 'Press Start 2P'",context.fillText(player.score,150,50),context.fillText(computer.score,450,50),context.beginPath(),context.arc(ball.x,ball.y,ball.radius,0,2*Math.PI),context.fill(),context.fillRect(player.x,player.y,player.width,player.height),context.fillRect(computer.x,computer.y,computer.width,computer.height)}function update(){ball.x+=ball.dx,ball.y+=ball.dy;const e={easy:.07,medium:.1,hard:.13};computer.y+=.1*(ball.y-(computer.y+40))*e[currentDifficulty],(ball.y+ball.radius>400||ball.y-ball.radius<0)&&(ball.dy*=-1);let t=ball.x<300?player:computer;ball.x-ball.radius<t.x+t.width&&ball.x+ball.radius>t.x&&ball.y-ball.radius<t.y+t.height&&ball.y+ball.radius>t.y&&(ball.dx*=-1,ball.speed+=.5,ball.dx=0<ball.dx?ball.speed:-ball.speed),ball.x+ball.radius>600?(player.score++,resetBall()):ball.x-ball.radius<0&&(computer.score++,resetBall()),draw(),player.score>=WINNING_SCORE?gameOver(!0):computer.score>=WINNING_SCORE?gameOver(!1):gameLoopId=requestAnimationFrame(update)}function gameOver(e){cancelAnimationFrame(gameLoopId),overlay.style.display="flex";const t=Math.abs(player.score-computer.score);e?(overlay.innerHTML=<h3>Du hast gewonnen!</h3><p>Endstand: \ zu \</p><form id="highscore-form"><input type="text" id="player-name" placeholder="Dein Name..." required><button type="submit">Highscore (\ Pkt.) speichern</button></form><p>Neues Spiel:</p><div><button onclick="startGame('easy')">Leicht</button>...</div>,document.getElementById("highscore-form").addEventListener("submit",function(e){e.preventDefault(),fetch("{% url 'games:save_score' %}",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":"{{ csrf_token }}"},body:JSON.stringify({player_name:document.getElementById("player-name").value,score:t,game:"Pong",difficulty:currentDifficulty})}).then(()=>window.location.href="{% url 'games:highscores' %}")})):overlay.innerHTML=<h3>Computer hat gewonnen!</h3><p>Endstand: \ zu \</p><p>Neues Spiel:</p><div><button onclick="startGame('easy')">Leicht</button>...</div>}canvas.addEventListener("mousemove",e=>{player.y=e.clientY-canvas.getBoundingClientRect().top-40});</script>{% endblock %}
