{% extends 'base.html' %}
{% block title %}Galgenmännchen{% endblock %}
{% block content %}
    <h2>Galgenmännchen</h2>

    <style>
        .word-display { font-size: 2.5em; letter-spacing: 0.5em; margin: 30px 0; }
        .keyboard { margin: 20px 0; }
        .keyboard button { font-size: 1.2em; width: 50px; height: 50px; margin: 3px; }
        .keyboard button.guessed { background-color: #6c757d; color: #1a1a2e; cursor: not-allowed; }
        .hangman-drawing { font-family: monospace, monospace; white-space: pre; font-size: 1.2em; color: #e94560; }
        .difficulty-button { display: inline-block; text-decoration: none; padding: 15px 25px; margin: 10px; border-radius: 0; font-size: 1em; color: #FFFFFF; cursor: pointer; border: 2px solid; }
        .easy { background-color: #28a745; border-color: #28a745; }
        .medium { background-color: #ffc107; border-color: #ffc107; color: #1a1a2e;}
        .hard { background-color: #dc3545; border-color: #dc3545; }
    </style>
    
    {% if 'hangman_difficulty' not in request.session %}
        <h3>Wähle eine Schwierigkeitsstufe:</h3>
        <form method="post">
            {% csrf_token %}
            <button class="difficulty-button easy" type="submit" name="difficulty" value="easy">Leicht (8 Versuche)</button>
            <button class="difficulty-button medium" type="submit" name="difficulty" value="medium">Mittel (6 Versuche)</button>
            <button class="difficulty-button hard" type="submit" name="difficulty" value="hard">Schwer (5 Versuche)</button>
        </form>
    {% else %}
        <div class="hangman-drawing">
            {% if guesses_left <= 5 %}  +---_--+{% endif %}<br>
            {% if guesses_left <= 5 %}  |      |{% endif %}<br>
            {% if guesses_left <= 4 %}  |      O{% endif %}<br>
            {% if guesses_left == 3 %}  |      |{% endif %}
            {% if guesses_left == 2 %}  |     /|{% endif %}
            {% if guesses_left <= 1 %}  |     /|\{% endif %}<br>
            {% if guesses_left <= 3 %}  |     {% endif %}<br>
            {% if guesses_left == 1 %}  |     /{% endif %}
            {% if guesses_left <= 0 %}  |     / \{% endif %}<br>
            {% if guesses_left <= 5 %}  |         {% endif %}<br>
            {% if guesses_left <= 5 %}=========={% endif %}<br>
        </div>

        <div class="word-display">{{ display_word }}</div>
        
        {% if winner %}
            <h3>{{ message }}</h3>
            {% if winner == 'player' %}
                <form method="post">
                    {% csrf_token %}
                    <input type="text" name="player_name" placeholder="Dein Name..." required>
                    <button type="submit">Highscore ({{ guesses_left }} Versuche übrig) speichern!</button>
                </form>
            {% endif %}
            <a href="{% url 'games:hangman' %}?reset=true" class="play-button" style="display:inline-block; text-decoration:none; padding:10px 20px;">Neues Spiel</a>
        {% else %}
            <h3>Noch {{ guesses_left }} Fehlversuche übrig.</h3>
            <div class="keyboard">
                <form method="post">
                    {% csrf_token %}
                    {% for letter in alphabet %}
                        {% if letter in guessed_letters %}
                            <button type="button" class="guessed" disabled>{{ letter }}</button>
                        {% else %}
                            <button type="submit" name="guess" value="{{ letter }}">{{ letter }}</button>
                        {% endif %}
                    {% endfor %}
                </form>
            </div>
        {% endif %}
    {% endif %}

    <p style="margin-top: 30px;"><a href="{% url 'games:game_list' %}">Zurück zur Spiele-Übersicht</a></p>
{% endblock %}